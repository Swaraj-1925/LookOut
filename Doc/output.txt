============================================================
INITIALIZING COMPLETE PIPELINE
============================================================

Initializing Face Recognition Pipeline...
Applied providers: ['CUDAExecutionProvider', 'CPUExecutionProvider'], with options: {'CPUExecutionProvider': {}, 'CUDAExecutionProvider': {'sdpa_kernel': '0', 'use_tf32': '1', 'fuse_conv_bias': '0', 'prefer_nhwc': '0', 'tunable_op_max_tuning_duration_ms': '0', 'enable_skip_layer_norm_strict_mode': '0', 'tunable_op_tuning_enable': '0', 'tunable_op_enable': '0', 'use_ep_level_unified_stream': '0', 'device_id': '0', 'has_user_compute_stream': '0', 'gpu_external_empty_cache': '0', 'cudnn_conv_algo_search': 'EXHAUSTIVE', 'cudnn_conv1d_pad_to_nc1d': '0', 'gpu_mem_limit': '18446744073709551615', 'gpu_external_alloc': '0', 'gpu_external_free': '0', 'arena_extend_strategy': 'kNextPowerOfTwo', 'do_copy_in_default_stream': '1', 'enable_cuda_graph': '0', 'user_compute_stream': '0', 'cudnn_conv_use_max_workspace': '1'}}
find model: /home/kevin/.insightface/models/buffalo_l/1k3d68.onnx landmark_3d_68 ['None', 3, 192, 192] 0.0 1.0
Applied providers: ['CUDAExecutionProvider', 'CPUExecutionProvider'], with options: {'CPUExecutionProvider': {}, 'CUDAExecutionProvider': {'sdpa_kernel': '0', 'use_tf32': '1', 'fuse_conv_bias': '0', 'prefer_nhwc': '0', 'tunable_op_max_tuning_duration_ms': '0', 'enable_skip_layer_norm_strict_mode': '0', 'tunable_op_tuning_enable': '0', 'tunable_op_enable': '0', 'use_ep_level_unified_stream': '0', 'device_id': '0', 'has_user_compute_stream': '0', 'gpu_external_empty_cache': '0', 'cudnn_conv_algo_search': 'EXHAUSTIVE', 'cudnn_conv1d_pad_to_nc1d': '0', 'gpu_mem_limit': '18446744073709551615', 'gpu_external_alloc': '0', 'gpu_external_free': '0', 'arena_extend_strategy': 'kNextPowerOfTwo', 'do_copy_in_default_stream': '1', 'enable_cuda_graph': '0', 'user_compute_stream': '0', 'cudnn_conv_use_max_workspace': '1'}}
find model: /home/kevin/.insightface/models/buffalo_l/2d106det.onnx landmark_2d_106 ['None', 3, 192, 192] 0.0 1.0
Applied providers: ['CUDAExecutionProvider', 'CPUExecutionProvider'], with options: {'CPUExecutionProvider': {}, 'CUDAExecutionProvider': {'sdpa_kernel': '0', 'use_tf32': '1', 'fuse_conv_bias': '0', 'prefer_nhwc': '0', 'tunable_op_max_tuning_duration_ms': '0', 'enable_skip_layer_norm_strict_mode': '0', 'tunable_op_tuning_enable': '0', 'tunable_op_enable': '0', 'use_ep_level_unified_stream': '0', 'device_id': '0', 'has_user_compute_stream': '0', 'gpu_external_empty_cache': '0', 'cudnn_conv_algo_search': 'EXHAUSTIVE', 'cudnn_conv1d_pad_to_nc1d': '0', 'gpu_mem_limit': '18446744073709551615', 'gpu_external_alloc': '0', 'gpu_external_free': '0', 'arena_extend_strategy': 'kNextPowerOfTwo', 'do_copy_in_default_stream': '1', 'enable_cuda_graph': '0', 'user_compute_stream': '0', 'cudnn_conv_use_max_workspace': '1'}}
find model: /home/kevin/.insightface/models/buffalo_l/det_10g.onnx detection [1, 3, '?', '?'] 127.5 128.0
Applied providers: ['CUDAExecutionProvider', 'CPUExecutionProvider'], with options: {'CPUExecutionProvider': {}, 'CUDAExecutionProvider': {'sdpa_kernel': '0', 'use_tf32': '1', 'fuse_conv_bias': '0', 'prefer_nhwc': '0', 'tunable_op_max_tuning_duration_ms': '0', 'enable_skip_layer_norm_strict_mode': '0', 'tunable_op_tuning_enable': '0', 'tunable_op_enable': '0', 'use_ep_level_unified_stream': '0', 'device_id': '0', 'has_user_compute_stream': '0', 'gpu_external_empty_cache': '0', 'cudnn_conv_algo_search': 'EXHAUSTIVE', 'cudnn_conv1d_pad_to_nc1d': '0', 'gpu_mem_limit': '18446744073709551615', 'gpu_external_alloc': '0', 'gpu_external_free': '0', 'arena_extend_strategy': 'kNextPowerOfTwo', 'do_copy_in_default_stream': '1', 'enable_cuda_graph': '0', 'user_compute_stream': '0', 'cudnn_conv_use_max_workspace': '1'}}
find model: /home/kevin/.insightface/models/buffalo_l/genderage.onnx genderage ['None', 3, 96, 96] 0.0 1.0
Applied providers: ['CUDAExecutionProvider', 'CPUExecutionProvider'], with options: {'CPUExecutionProvider': {}, 'CUDAExecutionProvider': {'sdpa_kernel': '0', 'use_tf32': '1', 'fuse_conv_bias': '0', 'prefer_nhwc': '0', 'tunable_op_max_tuning_duration_ms': '0', 'enable_skip_layer_norm_strict_mode': '0', 'tunable_op_tuning_enable': '0', 'tunable_op_enable': '0', 'use_ep_level_unified_stream': '0', 'device_id': '0', 'has_user_compute_stream': '0', 'gpu_external_empty_cache': '0', 'cudnn_conv_algo_search': 'EXHAUSTIVE', 'cudnn_conv1d_pad_to_nc1d': '0', 'gpu_mem_limit': '18446744073709551615', 'gpu_external_alloc': '0', 'gpu_external_free': '0', 'arena_extend_strategy': 'kNextPowerOfTwo', 'do_copy_in_default_stream': '1', 'enable_cuda_graph': '0', 'user_compute_stream': '0', 'cudnn_conv_use_max_workspace': '1'}}
find model: /home/kevin/.insightface/models/buffalo_l/w600k_r50.onnx recognition ['None', 3, 112, 112] 127.5 127.5
set det-size: (640, 640)
✓ Pipeline initialized
Initializing Body Detection Pipeline...
✓ Person detector loaded: yolov8x.pt
✓ Pose estimator loaded: yolov8x-pose.pt

============================================================
INITIALIZING RE-ID PIPELINE
============================================================

resnet50 loaded: on cuda
Re-ID Pipeline initialized

Video Tracker initialized with ByteTrack
All pipeline components initialized


============================================================
STARTING PERSON RE-ID PIPELINE
============================================================
Query: /home/kevin/Projects/LookOut/dataset/q/yt_speed_vid1.jpg
Video: /home/kevin/Projects/LookOut/dataset/vids/yt_speed_vid1.mp4
Output: test1
Face verification: ON
Temporal filtering: ON
============================================================

PHASE 1: FACE RECOGNITION (ArcFace)
Query embedding extracted: (512,)

============================================================
VIDEO INFO
============================================================
Total frames: 1191
Resolution: 1080x1920
FPS: 60.01
Duration: 19.85 seconds
Processing every 1 frame(s)
Verification threshold: 0.45
============================================================

Progress: 4.1% | Frames: 49/1191 | Matches: 0
Progress: 8.3% | Frames: 99/1191 | Matches: 0
Progress: 12.5% | Frames: 149/1191 | Matches: 0
Progress: 16.7% | Frames: 199/1191 | Matches: 19
Progress: 20.9% | Frames: 249/1191 | Matches: 20
Progress: 25.1% | Frames: 299/1191 | Matches: 20
Progress: 29.3% | Frames: 349/1191 | Matches: 20
Progress: 33.5% | Frames: 399/1191 | Matches: 20
Progress: 37.7% | Frames: 449/1191 | Matches: 20
Progress: 41.9% | Frames: 499/1191 | Matches: 27
Progress: 46.1% | Frames: 549/1191 | Matches: 43
Progress: 50.3% | Frames: 599/1191 | Matches: 61
Progress: 54.5% | Frames: 649/1191 | Matches: 107
Progress: 58.7% | Frames: 699/1191 | Matches: 149
Progress: 62.9% | Frames: 749/1191 | Matches: 149
Progress: 67.1% | Frames: 799/1191 | Matches: 151
Progress: 71.3% | Frames: 849/1191 | Matches: 151
Progress: 75.5% | Frames: 899/1191 | Matches: 169
Progress: 79.7% | Frames: 949/1191 | Matches: 170
Progress: 83.9% | Frames: 999/1191 | Matches: 170
Progress: 88.1% | Frames: 1049/1191 | Matches: 170
Progress: 92.3% | Frames: 1099/1191 | Matches: 170
Progress: 96.5% | Frames: 1149/1191 | Matches: 170

============================================================
EXTRACTION COMPLETE
============================================================
Total frames processed: 1191
Total matches found: 170
Match rate: 14.27%
Output folder: test1/phase1_faces
Metadata saved: test1/phase1_faces/matches_metadata.json
============================================================

✓ Found 170 face matches

PHASE 2: BODY DETECTION (YOLO + Pose)

============================================================
PHASE 2: BODY DETECTION
============================================================
Total face matches to process: 170
Detection strategy: hybrid
Video FPS: 60.00906938076284
Video duration: 19.85s
============================================================

Processed: 20/170
Processed: 40/170
Processed: 60/170
Processed: 80/170
Processed: 100/170
Processed: 120/170
Processed: 140/170
Processed: 160/170

============================================================
BODY DETECTION COMPLETE
============================================================
Total bodies extracted: 170
Detection methods used:
  - roi_detector: 170
Output folder: test1/phase2_bodies
Metadata saved: test1/phase2_bodies/body_detections_metadata.json
============================================================

✓ Extracted 170 body crops

PHASE 3: RE-ID GALLERY

============================================================
CREATING RE-ID GALLERY
============================================================
Processed: 50/170
Processed: 100/170
Processed: 150/170
✓ gallery created: 170 entries
✓ Saved to: test1/reid_gallery.json
============================================================

✓ Gallery size: 170 samples

PHASE 4: TRACKING (ByteTrack + Multi-Verification)

============================================================
TRACKING WITH BYTETRACK
============================================================
Video: 1080x1920 @ 60.01 FPS
Total frames: 1191
Re-ID threshold: 0.65
Face verification: ON
Temporal filtering: ON
============================================================

Progress: 0.0% | Frame: 0/1191 | Detections: 1
Progress: 8.4% | Frame: 100/1191 | Detections: 83
Progress: 16.8% | Frame: 200/1191 | Detections: 169
Progress: 25.2% | Frame: 300/1191 | Detections: 225
Progress: 33.6% | Frame: 400/1191 | Detections: 321
Progress: 42.0% | Frame: 500/1191 | Detections: 421
Progress: 50.4% | Frame: 600/1191 | Detections: 489
Progress: 58.8% | Frame: 700/1191 | Detections: 589
Progress: 67.2% | Frame: 800/1191 | Detections: 633
Progress: 75.6% | Frame: 900/1191 | Detections: 636
Progress: 84.0% | Frame: 1000/1191 | Detections: 650
Progress: 92.4% | Frame: 1100/1191 | Detections: 654

============================================================
TRACKING COMPLETE
============================================================
Frames processed: 1191
Frames with detection: 693
Detection rate: 58.2%
Target Track ID: 41
Output video: test1/tracked_video.mp4
Metadata: test1/tracked_video_tracking.json
============================================================

✓ Summary report saved: test1/pipeline_report.txt

============================================================
PIPELINE COMPLETE!
============================================================
Results: test1
Tracked video: test1/tracked_video.mp4
Face matches: 170
Body detections: 170
Tracked frames: 693
Detection rate: 693 frames
============================================================
